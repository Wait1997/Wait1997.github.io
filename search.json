[{"word":["1",".","Express","中","路由","和","中间件","路由","：","就是","如何","处理","HTTP","请求","中的","路径","部分","中间件","：","就是","在","收到","请求","后","和","发送","响应","之前","这个","阶段","执行","的","一些","函数","1.1","应用","及","中间件","123456789101112131415161718192021","next","方法","的","作用","就是","将","请求","传递","到","下一个","中间件","*","当","请求","进来","，","会","从","第一个","中间件","开始","进行","匹配","如果","匹配","，","则","进来","如果","请求","进入","中间件","之后","，","没有","调用","next","则","代码","会","停在","当前","中间件","如果","调用","了","next","则","继续","向后","找到","第","一个","匹配","的","中间件","如果","不","匹配","，","则","继续","判断","匹配","下一个","中间件","*","不关心","请求","路径","的","请求","不管","以","什么","路径","请求","只","要有","next","(",")","传递","app",".","use","(","(","req",",","res",",","next",")","=","&","#","123",";","console",".","log","(","'","1","'",")","1","next","(",")","&","#","125",";",")","app",".","use","(","(","req",",","res",",","next",")","=","&","#","123",";","console",".","log","(","'","2","'",")","2","next","(",")","&","#","125",";",")","app",".","use","(","(","req",",","res",".","next",")","=","&","#","123",";","console",".","log","(","'","3","'",")","3","&","#","125",";",")","1234567891011121314151617181920212223","关心","请求","路径","的","请求","app",".","use","(","(","req",",","res",",","next",")","=","&","#","123",";","console",".","log","(","'","1","'",")","next","(",")","&","#","125",";",")","app",".","use","(","'","b","'",",","(","req",",","res",",","next",")","=","&","#","123",";","console",".","log","(","'","b","'",")","&","#","125",";",")","以","a","开头","的","路径","中间件","app",".","use","(","'","a","'",",","(","req",",","res",",","next",")","=","&","#","123",";","console",".","log","(","'","a","'",")","next","(",")","&","#","125",";",")","app",".","use","(","(","req",",","res",",","next",")","=","&","#","123",";","console",".","log","(","'","2","'",")","&","#","125",";",")","当","在","浏览器","中","以","a","开头","的","请求","时","，","会","输出","1","a","2","当","在","浏览器","中","以","b","开头","的","请求","时","，","会","输出","1","b",",","这里","不会","输出","2","因为","当","请求","b","开头","的","请求","后","没有","next","(",")","方法","传递","就","会","停留","在","那个","请求","中","1.2","错误","处理","中间","件","1234567891011121314","app",".","use","(","'","user","'",",","(","req",",","res",",","next",")","=","&","#","123",";","try","&","#","123",";","console",".","log","(","has","error",")","next","(",")","&","#","125",";","catch","(","err",")","&","#","123",";","console",".","log","(","'","error","'",")","next","(","err",")","&","#","125",";","&","#","125",";",")","全局","错误","处理","中间件","app",".","use","(","(","err",",","req",",","res",",","next",")","=","&","#","123",";","console",".","log","(","err",".","stack",")","res",".","status","(","500",")",".","sen","(","'","error","message","'",")","&","#","125",";",")","12345678910111213141516171819202122232425262728293031323334","const","express","=","requre","(","'","express","'",")","const","fs","=","requre","(","'","fs","'",")","const","path","=","requre","(","'","path","'",")","const","app","=","express","(",")","app",".","get","(","'","a","'",",","(","req",",","res",",","next",")","=","&","#","123",";","fs",".","reaFle","(","path",".","jon","(","_","_","rname",",","'",".","atas",".","txt","'",")",",","'","utf","8","'",",","(","err",",","ata",")","=","&","#","123",";","f","(","err",")","&","#","123",";","return","next","(","err",")","&","#","125",";","console",".","log","(","ata",")","next","(",")","&","#","125",";",")","&","#","125",";",")","app",".","get","(","'","a","'",",","(","req",",","res",",","next",")","=","&","#","123",";","console",".","log","(","'","a","'",")","res",".","sen","(","'","a","'",")","&","#","125",";",")","当","不","匹配","任何","请求","路径","时","会","进去","此","错误","处理","app",".","use","(","(","req",",","res",",","next",")","=","&","#","123",";","res",".","sen","(","'","404","not","Foun","'",")","&","#","125",";",")","全局","错误","处理","中间件","app",".","use","(","(","err",",","req",",","res",",","next",")","=","&","#","123",";","res",".","status","(","500",")",".","sen","(","err",".","message",")","&","#","125",";",")","app",".","lsten","(","3000",",","(",")","=","&","#","123",";","console",".","log","(","'","runnng",".",".",".","'",")","&","#","125",";",")","1.3","express","中的","router","12345678910111213141516171819202122232425262728293031323334353637","app",".","jsconst","express","=","requre","(","'","express","'",")","const","publc","=","requre","(","'",".","routerpublc","'",")","const","user","=","requre","(","'",".","routeruser","'",")","const","app","=","express","(",")","app",".","use","(","'","publc","'",",","publc",")","当","请求","以","publc","开头","的","路径","时","才","会","进来","app",".","use","(","'","user","'",",","user",")","当","请求","以","uer","开头","的","路径","时","才","会","进来","app",".","lsten","(","3000",",","(",")","=","&","#","123",";","console",".","log","(","'","runnng",".",".",".","'",")","&","#","125",";",")","router","1",".","user",".","jsconst","express","=","requre","(","'","express","'",")","const","router","=","express",".","Router","(",")","router",".","get","(","'","a","'",",","(","req",",","res",")","=","&","#","123",";","res",".","sen","(","'","hello","noe","'",")","&","#","125",";",")","moule",".","exports","=","router","2",".","publc",".","jsconst","express","=","requre","(","'","express","'",")","const","router","=","express",".","Router","(",")","router",".","get","(","'","b","'",",","(","req",",","res",")","=","&","#","123",";","res",".","sen","(","'","hello","worl","'",")","&","#","125",";",")","moule",".","exports","=","router","app",".","router","(",")","要挂载","在","所有","第三方","中间件","的","后面","，","因为","前面","配置","的","中间件","是","app",".","router","(",")","中","请求","处理","函数","的","依赖"],"url":"http://yoursite.com/2020/01/13/Node%E4%B8%ADapp.use%E4%B8%AD%E9%97%B4%E4%BB%B6/","title":"Node中app.use中间件","content":"1. Express中路由和中间件路由：就是如何处理HTTP请求中的路径部分中间件：就是在收到请求后和发送响应之前这个阶段执行的一些函数1.1 应用及中间件123456789101112131415161718192021// nex...","author":"John Doe","categorie":{},"date":"2020-01-13 16:00:19"},{"word":["1",".","Cooke","和","Sesson","​","会话","管理","：","客户端","和","服务端","通信","过程","中的","数据","是","如何","管理","的","​","会话","管理","的","技术","：","数据","存","在","客户端","Cooke","​","数据","存","在","服务端","Sesson","​","Cooke",":","http","请","求是","无","状态","的","。","也就是说","即使","第一次","和","服务器","连接","后","并且","登录","成功","后","，","第二次","请求","服务器","依然","不能","知道","当前","请","求是","哪个","用户","。","cooke","的","出现","就是","为了","解决","这个问题","，","第一次","登录","后","服务器","返回","一些","数据","（","cooke","）","给","浏览器","，","然后","浏览器","保存","在","本地","，","当","该","用户","发送","第二次","请求","的","时候","，","就","会","自动","的","把","上次","请求","存储","的","cooke","数据","自动","的","携带","给","服务器","，","服务器","通过","浏览器","携带","的","数据","就","能","判断","当前","用户","是","哪个","了","。","cooke","存储","的","数据量","有限","，","不同的","浏览器","有","不同的","存储","大小","，","但","一般","不超过","4","KB","。","因此","使用","cooke","只能","存储","一些","小量","的","数据","​","Sesson",":","sesson","和","cooke","的","作用","有点","类似","，","都是","为了","存储","用户","相关","的","信息","。","不同的","是","，","cooke","是","存储","在","本地","浏览器","，","而","sesson","存储","在","服务器","。","存储","在","服务器","的","数据","会","更加","的","安全","，","不容易","被","窃取","。","但","存储","在","服务器","也","有","一定","的","弊端","，","就是","会","占用","服务器","的","资源","1.1","express","中","使用","cooke","-","parser","中间件","1.1.1","安装","：","npm","nstall","cooke","-","parser","-","S","1.1.2","引","包","：","const","cookeParser","=","requre","(","‘","cooke","-","parser","’",")","1.1.3","配置","cooke","-","parser","中间件","123","const","cookeParser","=","requre","(","'","cooke","-","parser","'",")","app",".","use","(","cookeParser","(","'","secret","'",")",")","1.1.4","在","服务器","通过","res",".","cooke","(",")","方法","创建","一个","cooke","12345678","cooke","的","配置","参数","：","maxAge",":","是","cooke","最大","的","有效","时间","单位","为","毫秒","expres","：","是","cooke","的","过期","时间","是","一个","ate","对象","httpOnly","：","当前","cooke","是否","只","能","被","web","服务器","获取","snge",":","是否","对","cooke","进行","签名","(","防止","cooke","被","用户","在","浏览器","修改",")","path","：","是","cooke","的","有效","访问","路径","(","如果","没有","设置","，","则","默认","为","根","路径",")","比如","我们","设置","了","path",":","&","quot",";","&","#","x","2","F",";","&","quot",";","，","即","意味着","访问","当前","网站","的","任何","接口","都会","携带","cooke","比如","我们","设置","了","path",":","&","quot",";","&","#","x","2","F",";","user","&","quot",";","，","即","意味着","只有","访问","有","&","#","x","2","F",";","user","开头","的","接口","才","会","在","请求","中","携带","cooke","1.1.5","设置","cooke","的","请求","1234","app",".","get","(","\"","setCooke","\"",",","(","req",",","res",")","=","&","#","123",";","res",".","cooke","(","\"","name","\"",",","\"","cookename","\"",",","&","#","123",";","path",":","\"","user","\"",",","maxAge",":","600000",",","httpOnly",":","true",",","'","sgne","'",":","true","&","#","125",";",")","res",".","sen","(","'","setcooke","'",")","&","#","125",";",")","1.1.6","浏览器","再次","请求","服务器","的","时候","会","将","之前","创建","的","cooke","放","在","请求","头","中","发送","给","服务器",",","服务器","此时","可以","通过","req",".","cookes","来","查看","当前","的","cooke","1234567891011","app",".","get","(","\"","getCooke","\"",",","(","req",",","res",")","=","&","#","123",";","如果","没有","对","cooke","进行","签名","，","则","通过","req",".","cookes","来","获取","cooke","如果","对","cooke","进行","了","签名","，","则","通过","req",".","sgneCookes","来","获取","cooke","console",".","log","(","req",".","cookes",",","req",".","sgneCookes",")","&","#","123",";","&","#","125",";","&","#","123",";","&","#","125",";","res",".","sen","(","'","getcooke","'",")","&","#","125",";",")","app",".","get","(","\"","user","\"",",","(","req",",","res",")","=","&","#","123",";","console",".","log","(","req",".","cookes",",","req",".","sgneCookes",")","&","#","123",";","&","#","125",";","&","#","123",";","name",":","'","cookename","'","&","#","125",";","res",".","sen","(","'","getcooke","'",")","&","#","125",";",")","1.1.7","Cooke","记住","用户名","123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263","const","express","&","#","x","3","D",";","requre","(","&","#","39",";","express","&","#","39",";",")","const","boyParser","&","#","x","3","D",";","requre","(","&","#","39",";","boy","-","parser","&","#","39",";",")","const","cookeParser","&","#","x","3","D",";","requre","(","&","#","39",";","cooke","-","parser","&","#","39",";",")","const","app","&","#","x","3","D",";","express","(",")","app",".","use","(","boyParser",".","urlencoe","(","&","#","123",";","extene",":","false","&","#","125",";",")",")","app",".","use","(","boyParser",".","json","(",")",")","app",".","engne","(","&","#","39",";","html","&","#","39",";",",","requre","(","&","#","39",";","express","-","art","-","template","&","#","39",";",")",")","app",".","set","(","&","#","39",";","ews","&","#","39",";",",","_","_","rname","+","&","#","39",";","&","#","x","2","F",";","ews","&","#","39",";",")","app",".","use","(","cookeParser","(","&","#","39",";","xaoxong","&","#","39",";",")",")","app",".","get","(","&","#","39",";","&","#","x","2","F",";","logn","&","#","39",";",",","(","req",",","res",")","&","#","x","3","D",";","&","#","123",";","f","(","req",".","sgneCookes",".","name",")","&","#","123",";","res",".","rener","(","&","#","39",";","logn",".","html","&","#","39",";",",","&","#","123",";","name",":","req",".","sgneCookes",".","name","&","#","125",";",")","&","#","125",";","res",".","rener","(","&","#","39",";","logn",".","html","&","#","39",";",")","&","#","125",";",")","app",".","get","(","&","#","39",";","&","#","x","2","F",";","usercenter","&","#","39",";",",","(","req",",","res",")","&","#","x","3","D",";","&","#","123",";","f","(","req",".","sgneCookes",".","name",")","&","#","123",";","res",".","rener","(","&","#","39",";","usercenter",".","html","&","#","39",";",",","&","#","123",";","name",":","req",".","sgneCookes",".","name","&","#","125",";",")","&","#","125",";","res",".","rener","(","&","#","39",";","usercenter",".","html","&","#","39",";",")","&","#","125",";",")","app",".","post","(","&","#","39",";","&","#","x","2","F",";","logn","&","#","39",";",",","(","req",",","res",")","&","#","x","3","D",";","&","#","123",";","let","name","&","#","x","3","D",";","req",".","boy",".","name","let","pw","&","#","x","3","D",";","req",".","boy",".","pw","let","rmbname","&","#","x","3","D",";","req",".","boy",".","rmbname","&","#","x","2","F",";","&","#","x","2","F",";","console",".","log","(","name","+","&","#","39",";","-","-","-","&","#","39",";","+","pw","+","&","#","39",";","-","-","-","&","#","39",";","+","&","#","39",";","-","-","-","&","#","39",";","+","rmbname",")","f","(","rmbname","&","#","x","3","D",";","&","#","x","3","D",";","&","#","39",";","on","&","#","39",";",")","&","#","123",";","f","(","name","&","#","x","3","D",";","&","#","x","3","D",";","&","#","39",";","朱艳","&","#","39",";","&","amp",";","&","amp",";","pw","&","#","x","3","D",";","&","#","x","3","D",";","&","#","39",";","zhuyan","&","#","39",";",")","&","#","123",";","res",".","cooke","(","&","#","39",";","name","&","#","39",";",",","name",",","&","#","123",";","maxAge",":","60000",",","httpOnly",":","true",",","&","#","39",";","sgne","&","#","39",";",":","true","&","#","125",";",")","res",".","rerect","(","&","#","39",";","&","#","x","2","F",";","usercenter","&","#","39",";",")","&","#","125",";","else","&","#","123",";","res",".","sen","(","&","#","39",";","账号","或者","密码","有误","&","#","39",";",")","&","#","125",";","&","#","125",";","else","&","#","123",";","f","(","name","&","#","x","3","D",";","&","#","x","3","D",";","&","#","39",";","朱艳","&","#","39",";","&","amp",";","&","amp",";","pw","&","#","x","3","D",";","&","#","x","3","D",";","&","#","39",";","zhuyan","&","#","39",";",")","&","#","123",";","res",".","rerect","(","&","#","39",";","&","#","x","2","F",";","usercenter","&","#","39",";",")","&","#","125",";","else","&","#","123",";","res",".","sen","(","&","#","39",";","账号","或者","密码","错误","&","#","39",";",")","&","#","125",";","&","#","125",";","&","#","125",";",")","app",".","lsten","(","3000",",","(",")","&","#","x","3","D",";","&","#","123",";","console",".","log","(","&","#","39",";","runnng",".",".","&","#","39",";",")","&","#","125",";",")","2.1","express","中","express","-","sesson","中间件","2.1.1","安装","：","npm","nstall","express","-","sesson","-","S","2.1.2","引","包","：","const","expressSesson","=","requre","(","‘","express","-","sesson","’",")","2.1.3","配置","中间件","12345678910111213141516","app",".","use","(","expressSesson","(","&","#","123",";","name",":","\"","cooke","\"",",","指定","所","创建","的","sesson","对应","的","cooke","的","名字","secret",":","'","secret","'",",","指定","是否","要","签名","这个","cooke","resae",":","强制","保存","sesson","即使","它","并没有","变化",",","。","默认","为","true","。","建议","设置","成","false","。","但是","这个","并不一定","是","必须","的","，","如果","客户端","有","两个","并行","的","请求","到","你","的","服务端","，","一个","请求","对","sesson","的","修改","可能","被","另外","一个","请求","覆盖","掉","，","即使","第二个","请求","并没有","修改","sesson","resae",":","false",",","rollng",":","强制","在","每一个","response","中都","发送","sesson","标识符","的","cooke","。","rolng","默认","是","false","。","如果","把","这个","值","设置","为","true","但是","saeUntalze","设置","为","false",",","没","有","初始化","的","sesson","的","cooke","不会","被","包含","在","响应","中","。","主要","作用","：","每次","请求","都","重置","cooke","过期","时间","rollng",":","true",",","强制","没有","“","初始化","”","的","sesson","保存","到","storage","(","store",":","保存","sesson","的","地方",")","中","，","没","有","初始化","的","sesson","指","的","是","刚","被","创建","没","有","被","修改","。","默认","是","true",",","但是","不","建议","使用","默认值","saeUnntalze",":","false",",","cooke",":","&","#","123",";","maxAge",":","1000","*","60","*","3",",","指定","sesson","对应","的","cooke","的","有效","时间","&","#","125",";",",","&","#","125",";",")",")","2.1.4","设置","sesson","1234","app",".","get","(","&","#","39",";","&","#","x","2","F",";","setsesson","&","#","39",";",",","(","req",",","res",")","&","#","x","3","D",";","&","#","123",";","req",".","sesson",".","usernfo","&","#","x","3","D",";","&","#","39",";","xaoyang","&","#","39",";","res",".","sen","(","&","#","39",";","setsesson","&","#","39",";",")","&","#","125",";",")","2.1.5","得","到","sesson","1234","app",".","get","(","'","getsesson","'",",","(","req",",","res",")","=","&","#","123",";","console",".","log","(","req",".","sesson",")","res",".","sen","(","req",".","sesson",".","usernfo",")","&","#","125",";",")","2.1.6","sesson","登录","案例","123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081","const","express","=","requre","(","'","express","'",")","const","expressSesson","=","requre","(","'","express","-","sesson","'",")","const","boyParser","=","requre","(","'","boy","-","parser","'",")","const","app","=","express","(",")","app",".","use","(","boyParser",".","urlencoe","(","&","#","123",";","extene",":","false","&","#","125",";",")",")","app",".","use","(","boyParser",".","json","(",")",")","app",".","engne","(","'","html","'",",","requre","(","'","express","-","art","-","template","'",")",")","app",".","set","(","'","ews","'",",","_","_","rname","+","'","ews","'",")","app",".","use","(","expressSesson","(","&","#","123",";","name",":","\"","cooke","\"",",","指定","所","创建","的","sesson","对应","的","cooke","的","名字","secret",":","'","secret","'",",","指定","是否","要","签名","这个","cooke","resae",":","false",",","rollng",":","true",",","saeUnntalze",":","false",",","cooke",":","&","#","123",";","maxAge",":","1000","*","60","*","3",",","指定","sesson","对应","的","cooke","的","有效","时间","&","#","125",";",",","&","#","125",";",")",")","app",".","get","(","'","logn","'",",","(","req",",","res",")","=","&","#","123",";","let","user","=","req",".","sesson",".","user","console",".","log","(","user",")","res",".","rener","(","'","logn",".","html","'",",","user",")","&","#","125",";",")","app",".","post","(","'","logn","'",",","(","req",",","res",")","=","&","#","123",";","获取","请求","参数","信息","let","name","=","req",".","boy",".","name","let","pw","=","req",".","boy",".","pw","如果","用户","登录","成功","则","把","用户","的","信息","存储","到","sesson","中","f","(","name","=","=","'","sessonName","'","&","amp",";","&","amp",";","pw","=","=","'","123","'",")","&","#","123",";","存储","会话","数据","req",".","sesson",".","user","=","req",".","boy","跳转","到","用户","中心","页面","res",".","rerect","(","'","usercenter","'",")","&","#","125",";","else","&","#","123",";","res",".","sen","(","'","账号","或者","密码","错误","'",")","&","#","125",";","&","#","125",";",")","app",".","get","(","'","usercenter","'",",","(","req",",","res",")","=","&","#","123",";","从","sesson","中","获取","之前","保存","的","数据","let","user","=","req",".","sesson",".","user","console",".","log","(","user",")","f","(","user","&","amp",";","&","amp",";","user",".","name",")","&","#","123",";","res",".","rener","(","'","usercenter",".","html","'",",","&","#","123",";","name",":","user",".","name","&","#","125",";",")","&","#","125",";","else","&","#","123",";","res",".","rener","(","'","usercenter",".","html","'",",","&","#","123",";","name",":","'","efault","'","&","#","125",";",")","&","#","125",";","&","#","125",";",")","退出","的","登录","app",".","get","(","'","layout","'",",","(","req",",","res",")","=","&","#","123",";","清","空","sesson","req",".","sesson",".","estroy","(",")","res",".","rerect","(","'","home","'",")","&","#","125",";",")","app",".","get","(","'","home","'",",","(","req",",","res",")","=","&","#","123",";","let","user","=","req",".","sesson",".","user","f","(","user","&","amp",";","&","amp",";","user",".","name",")","&","#","123",";","res",".","rener","(","\"","home",".","html","\"",",","&","#","123",";","name",":","user",".","name","&","#","125",";",")","&","#","125",";","else","&","#","123",";","res",".","rener","(","\"","home",".","html","\"",",","&","#","123",";","name",":","\"","efault","\"","&","#","125",";",")","&","#","125",";","&","#","125",";",")","app",".","lsten","(","3000",",","(",")","=","&","#","123",";","console",".","log","(","'","runnng",".",".",".","'",")","&","#","125",";",")"],"url":"http://yoursite.com/2020/01/13/express%E4%B8%ADcookie%E5%92%8Csession%E7%9A%84%E4%BD%BF%E7%94%A8/","title":"express中cookie和session的使用","content":"1.Cookie 和 Session​       会话管理：客户端和服务端通信过程中的数据是如何管理的\n​       会话管理的技术：数据存在客户端  Cookie\n​                               ...","author":"John Doe","categorie":{},"date":"2020-01-13 16:00:19"},{"word":["Welcome","to","Hexo","!","Ths","s","your","ery","frst","post",".","Check","ocumentaton","for","more","nfo",".","If","you","get","any","problems","when","usng","Hexo",",","you","can","fn","the","answer","n","troubleshootng","or","you","can","ask","me","on","GtHub",".","Quck","StartCreate","a","new","post","1","$","hexo","new","\"","My","New","Post","\"","More","nfo",":","Wrtng","Run","serer","1","$","hexo","serer","More","nfo",":","Serer","Generate","statc","fles","1","$","hexo","generate","More","nfo",":","Generatng","Deploy","to","remote","stes","1","$","hexo","eploy","More","nfo",":","Deployment"],"url":"http://yoursite.com/2020/01/13/hello-world/","title":"Hello World","content":"Welcome to Hexo! This is your very first post. Check documentation for more info. If you get any problems when using ...","author":"John Doe","categorie":{},"date":"2020-01-13 14:57:33"}]